select customer_id, sum(amount),
Rank() OVER(ORDER BY sum(amount) desc) RankAmount
from payment
group by customer_id

148	211.55	1
526	208.58	2
178	194.61	3
137	191.62	4
144	189.60	5
459	183.63	6
181	167.67	7
410	167.62	8
236	166.61	9
403	162.67	10
522	161.68	11
469	158.65	12
470	157.69	13
373	156.66	14
259	154.70	15
468	154.66	16
462	152.69	17
372	152.68	18
187	151.73	19
550	151.69	20
176	151.68	21
532	149.69	22
75	149.61	23
209	147.71	24
86	146.68	25
26	146.68	26
21	146.68	27
211	146.67	28
346	145.70	29
366	145.64	30
50	144.70	31
360	144.68	32
348	144.66	33
513	143.70	34
454	143.68	35
347	142.70	36
390	142.69	37
267	142.67	38
257	142.66	39
39	141.71	40
78	141.69	41
362	140.69	42
363	139.72	43
368	139.69	44
119	139.69	45
66	139.67	46
237	138.69	47
29	138.65	48
87	137.72	49
80	137.70	50
439	137.67	51
558	135.72	52
494	135.70	53
576	135.68	54
591	134.73	55
467	134.72	56
479	134.71	57
210	134.70	58
120	134.70	59
204	134.69	60
15	134.68	61
5	134.65	62
349	133.72	63
404	133.71	64
172	133.70	65
197	133.68	66
265	132.72	67
533	132.70	68
380	132.65	69
472	131.74	70
13	131.73	71
46	131.69	72
125	131.69	73
3	130.76	74
273	130.72	75
7	130.72	76
502	130.70	77
566	130.68	78
342	130.68	79
112	129.72	80
560	129.71	81
102	129.70	82
168	129.68	83
484	128.73	84
103	128.71	85
242	128.71	86
84	128.70	87
196	128.69	88
448	127.73	89
221	127.73	90
520	127.69	91
141	127.69	92
38	127.66	93
200	126.74	94
206	126.73	95
146	126.73	96
436	126.73	97
108	126.72	98
114	126.70	99
426	125.74	100
482	125.74	101
295	125.72	102
147	125.68	103
354	125.67	104
45	124.74	105
89	124.71	106
198	124.68	107
129	124.66	108
2	123.74	109
300	123.74	110
506	123.72	111
371	123.71	112
51	123.70	113
27	123.70	114
30	123.66	115
434	122.74	116
92	122.74	117
535	122.72	118
163	122.71	119
244	122.70	120
473	122.69	121
508	121.77	122
166	121.73	123
497	121.73	124
451	121.70	125
438	121.70	126
406	121.69	127
491	120.75	128
423	120.74	129
179	120.74	130
499	120.71	131
122	120.70	132
59	119.76	133
389	119.75	134
487	119.74	135
306	119.72	136
207	119.72	137
82	118.76	138
41	118.75	139
589	118.75	140
565	118.73	141
128	118.70	142
35	118.70	143
230	118.69	144
583	117.77	145
285	117.77	146
585	117.76	147
504	117.75	148
421	117.75	149
573	117.72	150
49	116.76	151
149	116.75	152
253	116.74	153
274	116.73	154
263	116.73	155
71	116.72	156
356	116.71	157
512	115.74	158
56	115.74	159
529	115.72	160
393	115.71	161
158	115.70	162
279	114.76	163
54	114.74	164
584	114.73	165
262	114.73	166
107	114.72	167
388	114.72	168
1	114.70	169
433	113.77	170
309	113.75	171
266	113.74	172
302	113.74	173
139	113.73	174
569	113.73	175
416	113.72	176
314	113.71	177
260	113.70	178
540	112.76	179
582	112.76	180
63	112.75	181
32	112.74	182
131	112.73	183
485	112.72	184
453	111.77	185
337	111.76	186
225	111.76	187
577	111.74	188
173	111.73	189
579	111.73	190
113	111.73	191
186	111.71	192
592	111.71	193
42	111.71	194
531	110.77	195
258	110.76	196
495	110.76	197
515	110.74	198
154	110.73	199
213	110.73	200
559	110.72	201
90	110.72	202
595	110.71	203
241	110.68	204
170	109.77	205
536	109.77	206
575	109.76	207
220	109.75	208
16	109.75	209
538	109.73	210
376	109.73	211
447	109.73	212
386	109.72	213
446	109.72	214
481	109.72	215
424	109.71	216
284	108.78	217
594	108.77	218
590	108.76	219
277	108.76	220
518	108.75	221
334	108.75	222
574	108.73	223
239	108.72	224
167	108.71	225
293	107.79	226
571	107.78	227
427	107.77	228
332	107.74	229
441	107.73	230
145	107.73	231
588	107.73	232
157	107.71	233
254	107.70	234
418	107.70	235
91	107.66	236
477	106.79	237
343	106.77	238
240	106.77	239
155	106.76	240
234	106.75	241
471	106.74	242
116	106.74	243
23	106.73	244
457	106.73	245
160	106.73	246
52	106.72	247
138	106.68	248
127	105.78	249
490	105.78	250
331	105.78	251
193	105.77	252
294	105.77	253
58	105.76	254
400	105.76	255
396	105.74	256
40	105.74	257
96	105.73	258
444	105.72	259
28	105.70	260
345	104.79	261
493	104.78	262
289	104.76	263
121	104.75	264
171	104.75	265
407	104.74	266
31	104.74	267
25	104.73	268
397	104.72	269
442	104.71	270
341	103.78	271
296	103.77	272
280	103.77	273
214	103.74	274
202	103.74	275
245	103.74	276
20	103.73	277
408	103.73	278
292	102.78	279
553	102.77	280
510	102.77	281
587	102.76	282
98	102.76	283
126	102.75	284
190	102.75	285
44	101.79	286
466	101.78	287
100	101.77	288
593	101.76	289
405	101.70	290
486	100.77	291
517	100.76	292
572	100.76	293
219	100.75	294
251	100.75	295
135	100.72	296
519	99.78	297
11	99.77	298
57	99.74	299
297	99.74	300
563	99.73	301
503	99.72	302
452	99.71	303
381	99.68	304
19	98.82	305
329	98.77	306
537	98.76	307
175	98.76	308
264	98.75	309
425	98.75	310
374	98.75	311
580	98.74	312
65	97.80	313
367	97.80	314
460	97.79	315
409	97.78	316
192	97.78	317
475	97.78	318
562	97.78	319
123	97.77	320
256	97.75	321
581	97.75	322
268	96.79	323
379	96.79	324
269	96.79	325
352	96.78	326
83	96.78	327
14	96.77	328
414	96.77	329
286	96.76	330
445	96.76	331
317	96.76	332
500	96.75	333
422	96.75	334
74	96.74	335
554	95.80	336
578	95.79	337
106	95.79	338
180	95.78	339
324	95.78	340
541	95.78	341
488	95.78	342
339	95.76	343
199	95.76	344
456	95.76	345
132	95.72	346
22	94.81	347
150	94.78	348
68	94.78	349
276	94.77	350
161	94.76	351
546	94.76	352
153	94.76	353
10	94.76	354
111	94.75	355
321	93.83	356
432	93.80	357
528	93.80	358
319	93.79	359
443	93.79	360
105	93.78	361
336	93.78	362
385	93.76	363
383	93.75	364
229	93.75	365
377	93.74	366
12	93.74	367
47	92.81	368
307	92.80	369
544	92.80	370
81	92.79	371
365	92.79	372
511	92.78	373
431	92.78	374
516	92.76	375
182	92.76	376
474	92.75	377
188	92.75	378
275	92.75	379
505	91.81	380
489	91.81	381
212	91.80	382
37	91.79	383
201	91.78	384
417	91.78	385
392	91.77	386
323	91.75	387
570	91.75	388
64	91.70	389
261	90.78	390
216	90.78	391
99	90.77	392
36	90.75	393
461	90.73	394
552	89.80	395
43	89.78	396
364	89.78	397
333	89.78	398
73	89.78	399
235	89.77	400
233	89.77	401
507	89.77	402
156	89.77	403
69	89.77	404
463	89.76	405
34	89.76	406
361	89.71	407
247	88.81	408
249	88.81	409
33	88.80	410
375	88.80	411
415	88.78	412
60	88.78	413
231	88.77	414
53	88.76	415
133	88.75	416
72	88.73	417
17	87.82	418
203	87.81	419
523	87.80	420
305	87.80	421
476	87.80	422
547	87.80	423
226	87.79	424
189	87.79	425
130	87.78	426
597	87.77	427
351	87.77	428
509	86.82	429
478	86.81	430
501	86.81	431
238	86.81	432
195	86.81	433
67	86.80	434
169	86.80	435
217	86.79	436
232	86.77	437
101	86.77	438
419	86.76	439
228	86.75	440
561	86.75	441
208	86.75	442
115	86.73	443
567	85.80	444
437	85.80	445
382	85.78	446
359	85.78	447
455	85.78	448
24	85.77	449
8	85.77	450
77	85.77	451
450	85.75	452
542	84.84	453
55	84.81	454
545	84.81	455
539	84.80	456
88	84.80	457
299	84.79	458
6	84.75	459
140	83.82	460
480	83.81	461
143	83.80	462
440	83.79	463
598	83.78	464
340	83.77	465
496	82.81	466
564	82.78	467
498	82.76	468
524	81.83	469
483	81.83	470
322	81.81	471
308	81.81	472
174	81.81	473
165	81.80	474
312	81.80	475
4	81.78	476
534	81.78	477
527	81.76	478
215	81.76	479
151	81.75	480
311	80.85	481
449	80.83	482
205	80.82	483
316	80.81	484
184	80.80	485
287	80.78	486
290	80.78	487
521	80.77	488
357	80.77	489
304	79.81	490
109	79.81	491
282	79.80	492
185	79.80	493
387	79.78	494
391	79.75	495
429	78.84	496
599	78.82	497
18	78.81	498
338	78.80	499
9	78.80	500
298	78.79	501
62	78.79	502
227	78.78	503
435	78.77	504
223	77.84	505
402	77.81	506
134	77.81	507
394	77.80	508
384	77.79	509
104	77.78	510
243	77.77	511
246	76.82	512
93	76.80	513
118	76.80	514
224	76.78	515
70	75.83	516
270	75.81	517
358	75.80	518
551	75.79	519
183	75.78	520
530	75.78	521
194	74.84	522
412	74.83	523
555	74.83	524
327	74.81	525
420	74.80	526
76	74.79	527
142	74.77	528
398	73.85	529
291	73.83	530
399	73.82	531
152	73.81	532
79	73.81	533
428	73.81	534
543	73.80	535
596	73.78	536
335	73.78	537
411	73.76	538
95	72.83	539
556	72.82	540
325	72.82	541
85	72.79	542
301	71.85	543
222	71.84	544
94	71.81	545
430	71.80	546
278	71.79	547
177	71.77	548
255	70.82	549
378	70.82	550
370	70.81	551
303	70.81	552
117	69.83	553
369	69.79	554
514	69.79	555
310	68.87	556
465	68.84	557
525	68.82	558
355	68.81	559
283	68.77	560
48	67.86	561
464	67.86	562
315	67.86	563
218	67.82	564
191	66.82	565
458	66.81	566
568	66.79	567
272	65.87	568
353	65.83	569
328	65.83	570
413	65.81	571
164	64.85	572
344	64.84	573
326	64.82	574
313	63.84	575
548	63.84	576
350	63.79	577
557	63.78	578
492	62.85	579
549	62.84	580
401	62.81	581
330	60.82	582
136	59.86	583
162	59.83	584
159	58.83	585
97	58.82	586
252	58.80	587
61	57.87	588
124	57.86	589
395	57.81	590
271	56.84	591
250	54.85	592
288	52.81	593
586	50.83	594
110	49.88	595
320	47.85	596
248	37.87	597
281	32.90	598
318	27.93	599
38	127.66	93
200	126.74	94
206	126.73	95
146	126.73	96
436	126.73	97
108	126.72	98
114	126.70	99
426	125.74	100
482	125.74	101
295	125.72	102
147	125.68	103
354	125.67	104
45	124.74	105
89	124.71	106
198	124.68	107
129	124.66	108
2	123.74	109
300	123.74	110
506	123.72	111
371	123.71	112
51	123.70	113
27	123.70	114
30	123.66	115
434	122.74	116
92	122.74	117
535	122.72	118
163	122.71	119
244	122.70	120
473	122.69	121
508	121.77	122
166	121.73	123
497	121.73	124
451	121.70	125
438	121.70	126
406	121.69	127
491	120.75	128
423	120.74	129
179	120.74	130
499	120.71	131
122	120.70	132
59	119.76	133
389	119.75	134
487	119.74	135
306	119.72	136
207	119.72	137
82	118.76	138
41	118.75	139
589	118.75	140
565	118.73	141
128	118.70	142
35	118.70	143
230	118.69	144
583	117.77	145
285	117.77	146
585	117.76	147
504	117.75	148
421	117.75	149
573	117.72	150
49	116.76	151
149	116.75	152
253	116.74	153
274	116.73	154
263	116.73	155
71	116.72	156
356	116.71	157
512	115.74	158
56	115.74	159
529	115.72	160
393	115.71	161
158	115.70	162
279	114.76	163
54	114.74	164
584	114.73	165
262	114.73	166
107	114.72	167
388	114.72	168
1	114.70	169
433	113.77	170
309	113.75	171
266	113.74	172
302	113.74	173
139	113.73	174
569	113.73	175
416	113.72	176
314	113.71	177
260	113.70	178
540	112.76	179
582	112.76	180
63	112.75	181
32	112.74	182
131	112.73	183
485	112.72	184
453	111.77	185
337	111.76	186
225	111.76	187
577	111.74	188
173	111.73	189
579	111.73	190
113	111.73	191
186	111.71	192
592	111.71	193
42	111.71	194
531	110.77	195
258	110.76	196
495	110.76	197
515	110.74	198
154	110.73	199
213	110.73	200
559	110.72	201
90	110.72	202
595	110.71	203
241	110.68	204
170	109.77	205
536	109.77	206
575	109.76	207
220	109.75	208
16	109.75	209
538	109.73	210
376	109.73	211
447	109.73	212
386	109.72	213
446	109.72	214
481	109.72	215
424	109.71	216
284	108.78	217
594	108.77	218
590	108.76	219
277	108.76	220
518	108.75	221
334	108.75	222
574	108.73	223
239	108.72	224
167	108.71	225
293	107.79	226
571	107.78	227
427	107.77	228
332	107.74	229
441	107.73	230
145	107.73	231
588	107.73	232
157	107.71	233
254	107.70	234
418	107.70	235
91	107.66	236
477	106.79	237
343	106.77	238
240	106.77	239
155	106.76	240
234	106.75	241
471	106.74	242
116	106.74	243
23	106.73	244
457	106.73	245
160	106.73	246
52	106.72	247
138	106.68	248
127	105.78	249
490	105.78	250
331	105.78	251
193	105.77	252
294	105.77	253
58	105.76	254
400	105.76	255
396	105.74	256
40	105.74	257
96	105.73	258
444	105.72	259
28	105.70	260
345	104.79	261
493	104.78	262
289	104.76	263
121	104.75	264
171	104.75	265
407	104.74	266
31	104.74	267
25	104.73	268
397	104.72	269
442	104.71	270
341	103.78	271
296	103.77	272
280	103.77	273
214	103.74	274
202	103.74	275
245	103.74	276
20	103.73	277
408	103.73	278
292	102.78	279
553	102.77	280
510	102.77	281
587	102.76	282
98	102.76	283
126	102.75	284
190	102.75	285
44	101.79	286
466	101.78	287
100	101.77	288
593	101.76	289
405	101.70	290
486	100.77	291
517	100.76	292
572	100.76	293
219	100.75	294
251	100.75	295
135	100.72	296
519	99.78	297
11	99.77	298
57	99.74	299
297	99.74	300
563	99.73	301
503	99.72	302
452	99.71	303
381	99.68	304
19	98.82	305
329	98.77	306
537	98.76	307
175	98.76	308
264	98.75	309
425	98.75	310
374	98.75	311
580	98.74	312
65	97.80	313
367	97.80	314
460	97.79	315
409	97.78	316
192	97.78	317
475	97.78	318
562	97.78	319
123	97.77	320
256	97.75	321
581	97.75	322
268	96.79	323
379	96.79	324
269	96.79	325
352	96.78	326
83	96.78	327
14	96.77	328
414	96.77	329
286	96.76	330
445	96.76	331
317	96.76	332
500	96.75	333
422	96.75	334
74	96.74	335
554	95.80	336
578	95.79	337
106	95.79	338
180	95.78	339
324	95.78	340
541	95.78	341
488	95.78	342
339	95.76	343
199	95.76	344
456	95.76	345
132	95.72	346
22	94.81	347
150	94.78	348
68	94.78	349
276	94.77	350
161	94.76	351
546	94.76	352
153	94.76	353
10	94.76	354
111	94.75	355
321	93.83	356
432	93.80	357
528	93.80	358
319	93.79	359
443	93.79	360
105	93.78	361
336	93.78	362
385	93.76	363
383	93.75	364
229	93.75	365
377	93.74	366
12	93.74	367
47	92.81	368
307	92.80	369
544	92.80	370
81	92.79	371
365	92.79	372
511	92.78	373
431	92.78	374
516	92.76	375
182	92.76	376
474	92.75	377
188	92.75	378
275	92.75	379
505	91.81	380
489	91.81	381
212	91.80	382
37	91.79	383
201	91.78	384
417	91.78	385
392	91.77	386
323	91.75	387
570	91.75	388
64	91.70	389
261	90.78	390
216	90.78	391
99	90.77	392
36	90.75	393
461	90.73	394
552	89.80	395
43	89.78	396
364	89.78	397
333	89.78	398
73	89.78	399
235	89.77	400
233	89.77	401
507	89.77	402
156	89.77	403
69	89.77	404
463	89.76	405
34	89.76	406
361	89.71	407
247	88.81	408
249	88.81	409
33	88.80	410
375	88.80	411
415	88.78	412
60	88.78	413
231	88.77	414
53	88.76	415
133	88.75	416
72	88.73	417
17	87.82	418
203	87.81	419
523	87.80	420
305	87.80	421
476	87.80	422
547	87.80	423
226	87.79	424
189	87.79	425
130	87.78	426
597	87.77	427
351	87.77	428
509	86.82	429
478	86.81	430
501	86.81	431
238	86.81	432
195	86.81	433
67	86.80	434
169	86.80	435
217	86.79	436
232	86.77	437
101	86.77	438
419	86.76	439
228	86.75	440
561	86.75	441
208	86.75	442
115	86.73	443
567	85.80	444
437	85.80	445
382	85.78	446
359	85.78	447
455	85.78	448
24	85.77	449
8	85.77	450
77	85.77	451
450	85.75	452
542	84.84	453
55	84.81	454
545	84.81	455
539	84.80	456
88	84.80	457
299	84.79	458
6	84.75	459
140	83.82	460
480	83.81	461
143	83.80	462
440	83.79	463
598	83.78	464
340	83.77	465
496	82.81	466
564	82.78	467
498	82.76	468
524	81.83	469
483	81.83	470
322	81.81	471
308	81.81	472
174	81.81	473
165	81.80	474
312	81.80	475
4	81.78	476
534	81.78	477
527	81.76	478
215	81.76	479
151	81.75	480
311	80.85	481
449	80.83	482
205	80.82	483
316	80.81	484
184	80.80	485
287	80.78	486
290	80.78	487
521	80.77	488
357	80.77	489
304	79.81	490
109	79.81	491
282	79.80	492
185	79.80	493
387	79.78	494
391	79.75	495
429	78.84	496
599	78.82	497
18	78.81	498
338	78.80	499
9	78.80	500
298	78.79	501
62	78.79	502
227	78.78	503
435	78.77	504
223	77.84	505
402	77.81	506
134	77.81	507
394	77.80	508
384	77.79	509
104	77.78	510
243	77.77	511
246	76.82	512
93	76.80	513
118	76.80	514
224	76.78	515
70	75.83	516
270	75.81	517
358	75.80	518
551	75.79	519
183	75.78	520
530	75.78	521
194	74.84	522
412	74.83	523
555	74.83	524
327	74.81	525
420	74.80	526
76	74.79	527
142	74.77	528
398	73.85	529
291	73.83	530
399	73.82	531
152	73.81	532
79	73.81	533
428	73.81	534
543	73.80	535
596	73.78	536
335	73.78	537
411	73.76	538
95	72.83	539
556	72.82	540
325	72.82	541
85	72.79	542
301	71.85	543
222	71.84	544
94	71.81	545
430	71.80	546
278	71.79	547
177	71.77	548
255	70.82	549
378	70.82	550
370	70.81	551
303	70.81	552
117	69.83	553
369	69.79	554
514	69.79	555
310	68.87	556
465	68.84	557
525	68.82	558
355	68.81	559
283	68.77	560
48	67.86	561
464	67.86	562
315	67.86	563
218	67.82	564
191	66.82	565
458	66.81	566
568	66.79	567
272	65.87	568
353	65.83	569
328	65.83	570
413	65.81	571
164	64.85	572
344	64.84	573
326	64.82	574
313	63.84	575
548	63.84	576
350	63.79	577
557	63.78	578
492	62.85	579
549	62.84	580
401	62.81	581
330	60.82	582
136	59.86	583
162	59.83	584
159	58.83	585
97	58.82	586
252	58.80	587
61	57.87	588
124	57.86	589
395	57.81	590
271	56.84	591
250	54.85	592
288	52.81	593
586	50.83	594
110	49.88	595
320	47.85	596
248	37.87	597
281	32.90	598
318	27.93	599